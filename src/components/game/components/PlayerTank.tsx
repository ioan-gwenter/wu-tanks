/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import * as THREE from 'three'
import React, { useRef } from 'react'
import { useGLTF } from '@react-three/drei'
import { GLTF } from 'three-stdlib'

type GLTFResult = GLTF & {
    nodes: {
        Head: THREE.Mesh
        Barrel007: THREE.Mesh
        Barrel007_1: THREE.Mesh
        Body: THREE.Mesh
        Tracks007: THREE.Mesh
        Tracks007_1: THREE.Mesh
        Tracks007_2: THREE.Mesh
    }
    materials: {
        ['BodyMetallic.007']: THREE.MeshStandardMaterial
        ['TracksDark.008']: THREE.MeshStandardMaterial
        ['BodyFlat.007']: THREE.MeshStandardMaterial
    }
}

type PlayerTankProps = JSX.IntrinsicElements['group'] & {
    headRotation?: number;
    bodyRotation?: number;
    playerColor?: string; // Optional color for BodyFlat material
};


export function PlayerTank({
    headRotation = 0, // Default rotation
    bodyRotation = 0,// Default rotation
    playerColor = '#D1BDFF', // Default BodyFlat color
    ...props
}: PlayerTankProps) {
    const { nodes, materials } = useGLTF('/models/PlayerTank.glb') as GLTFResult;

    const bodyFlatMaterial = materials['BodyFlat.007'].clone();
    bodyFlatMaterial.color = new THREE.Color(playerColor);

    const bodyMetallicMaterial = materials['BodyMetallic.007'].clone();
    bodyMetallicMaterial.color = new THREE.Color(playerColor);


    return (
        <group {...props} dispose={null}>
            <group name="Scene">
                <mesh
                    name="Head"
                    castShadow
                    receiveShadow
                    geometry={nodes.Head.geometry}
                    material={bodyMetallicMaterial}
                    position={[0, 0.164, 0]}
                    rotation={[-Math.PI, headRotation, -Math.PI]} // Apply Z-axis rotation
                    scale={[0.098, 0.061, 0.098]}
                    userData={{ name: 'Head' }}>
                    <group
                        name="Barrel"
                        position={[0, -0.372, 0.939]}
                        rotation={[-Math.PI, 0, -Math.PI]}
                        scale={[-0.144, -0.233, -0.144]}
                        userData={{ name: 'Barrel' }}>
                        <mesh
                            name="Barrel007"
                            castShadow
                            receiveShadow
                            geometry={nodes.Barrel007.geometry}
                            material={bodyMetallicMaterial}
                        />
                        <mesh
                            name="Barrel007_1"
                            castShadow
                            receiveShadow
                            geometry={nodes.Barrel007_1.geometry}
                            material={materials['TracksDark.008']}
                        />
                    </group>
                </mesh>
                <mesh
                    name="Body"
                    castShadow
                    receiveShadow
                    geometry={nodes.Body.geometry}
                    material={bodyFlatMaterial}
                    // rotation={[0, 0, -Math.PI].map((defaultRot, i) => defaultRot + bodyDirection[i]) as [number, number, number]} for 3 dof
                    rotation={[0, bodyRotation, -Math.PI]}
                    scale={[-0.13, -0.052, -0.17]}
                    userData={{ name: 'Body' }}>
                    <group name="Tracks" scale={[1.3, 0.952, 0.952]} userData={{ name: 'Tracks' }}>
                        <mesh
                            name="Tracks007"
                            castShadow
                            receiveShadow
                            geometry={nodes.Tracks007.geometry}
                            material={bodyFlatMaterial}
                        />
                        <mesh
                            name="Tracks007_1"
                            castShadow
                            receiveShadow
                            geometry={nodes.Tracks007_1.geometry}
                            material={bodyMetallicMaterial}
                        />
                        <mesh
                            name="Tracks007_2"
                            castShadow
                            receiveShadow
                            geometry={nodes.Tracks007_2.geometry}
                            material={bodyFlatMaterial}
                        />
                    </group>
                </mesh>
            </group>
        </group>
    )
}

useGLTF.preload('/models/PlayerTank.glb')

